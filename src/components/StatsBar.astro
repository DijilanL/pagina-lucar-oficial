---
---
<div class="glass p-4 md:p-5">
  <div id="stats" class="grid grid-cols-2 md:grid-cols-4 gap-4">
    <div class="space-y-1"><div class="text-xs text-slate-400">Archivos</div><div class="h-6 w-20 bg-white/10 rounded animate-pulse"></div></div>
    <div class="space-y-1"><div class="text-xs text-slate-400">Tamaño total</div><div class="h-6 w-28 bg-white/10 rounded animate-pulse"></div></div>
    <div class="space-y-1"><div class="text-xs text-slate-400">Último</div><div class="h-6 w-40 bg-white/10 rounded animate-pulse"></div></div>
    <div class="space-y-1"><div class="text-xs text-slate-400">Bucket</div><div class="h-6 w-24 bg-white/10 rounded animate-pulse"></div></div>
  </div>
</div>

<script type="module">
  document.addEventListener("DOMContentLoaded", () => {
    /** @type {HTMLElement | null} */
    const el = document.getElementById("stats");
    if (!el) return; // ⬅️ guard

    const fmtBytes = (n = 0) => {
      const u = ["B","KB","MB","GB","TB"]; let i = 0;
      while (n >= 1024 && i < u.length - 1) { n /= 1024; i++; }
      return `${n.toFixed(1)} ${u[i]}`;
    };

    (async () => {
      const res = await fetch("/api/stats");
      if (!res.ok) { el.innerHTML = `<div class="text-red-400">Error</div>`; return; }
      const { total, bytes, last } = await res.json();
      const lastStr = last ? new Date(last).toLocaleString() : "—";
      el.innerHTML = `
        <div class="space-y-1"><div class="text-xs text-slate-400">Archivos</div><div class="text-xl font-semibold">${total}</div></div>
        <div class="space-y-1"><div class="text-xs text-slate-400">Tamaño total</div><div class="text-xl font-semibold">${fmtBytes(bytes)}</div></div>
        <div class="space-y-1"><div class="text-xs text-slate-400">Último</div><div class="text-xl font-semibold">${lastStr}</div></div>
        <div class="space-y-1"><div class="text-xs text-slate-400">Bucket</div><div class="text-xl font-semibold">uploads</div></div>
      `;
    })();
  });
</script>
